
<form action="" id="formulario" method="POST" role="form" enctype="multipart/form-data">
    
    <!-- nueva version simple -->
    <div class="row justify-content-center filafondo">
        <h5 class="tituloconfondo">Productos</h5>
    </div>
   

    <div class='row justify-content-center'>
        <div class="col-sm-3 border mt-1">
            <div class="row justify-content-center" style="margin-bottom: 0em;">
                <a id="nuevoanuncio" class="btn btn-success">Nuevo</a>
            </div>
            
            <div class="row justify-content-center" style="margin-bottom: 0em;">
                <img id="muestra" src='img/agregarimagen.jpg' class='materialboxed card-img-top center-align mt-1 tamaimagen '
                    alt='...'></img>
            <!-- style="width: 220px; height: auto;" -->

                    <form action="#">
                        <div class="file-field input-field">
                            <div class="btn">
                                <span>Imagen</span>
                                <input id="imagen" name="imagen"  type="file">
                            </div>
                            <div class="file-path-wrapper">
                                <input  class="file-path validate" type="text" placeholder="Seleccione una imagen para subir">
                            </div>
                        </div>
                    </form>

                <!-- <div class="input-group">
                    <div class="input-group-prepend">
                        <label class="custom-file-label" for="inputGroupFileAddon01">Seleccionar Imagen</label>
                    </div>
                    <div class="custom-file">
                        <input type="file" class="custom-file-input" id="imagen" name="imagen" aria-describedby="inputGroupFileAddon01">
                    </div>
                </div> -->
                <progress class="progress" id="barra" value="0" max="100">0%</progress>
                <label class="colorletras" for="" id="valorbarra">0%</label>
                <p class="red-text accent-4" id="aviso"></p>
            </div>
        </div>

        <div class="col-sm-3 border mt-1">
            <div class="row justify-content-center">
                <input style="display: none;" onKeyDown="return validartecla(event,this.value,50)"
                    onKeyUp="return validartecla(event,this.value,50)" id="rubro" name="rubro" type="text"
                    class="validate border border-success">
                <select class="form-control" id="opciones" name="opciones">
        
                    <!-- aca se inserta la consulta de rubros -->
        
                </select>
            </div>
            <div class="row justify-content-center">
                <input onKeyDown="return validartecla(event,this.value,50)" onKeyUp="return validartecla(event,this.value,50)"
                id="titulo" name="titulo" style="font-size: 1.2em;" type="text" class="validate border border-success center tooltipped" data-position="top" data-tooltip="Título de la publicación"
                placeholder="TITULO Ej: Pantalón elastizado">
            </div>
            <div class="row justify-content-center">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Descripción</span>
                    </div>
                    <textarea maxlength="200" class="form-control tooltipped" data-position="top" data-tooltip="Descripción del producto" id="descripcion" name="descripcion" aria-label="descripcion" style="height: 100px;"
                        class="border border-success"
                        placeholder="Ej: Varios talles y colores unisex, talles de niños y adultos"></textarea>
                </div>
            </div>
            <div class='row justify-content-center'>
                <div class="col">
                    <textarea rows="7" onKeyDown="return validartecla(event,this.value,1000)"
                        onKeyUp="return validartecla(event,this.value,1000)" class="form-control tooltipped" data-position="top" data-tooltip="Amplia la descripción" id="observaciones"
                        name="observaciones" aria-label="observaciones"
                        placeholder="SABER MAS : Esta sección permite extender la descripción de su producto"></textarea>
                </div>
            
                <div class="col">
                    <textarea rows="7" onKeyDown="return validartecla(event,this.value,1000)"
                        onKeyUp="return validartecla(event,this.value,1000)" class="form-control tooltipped" data-position="top" data-tooltip="Info que da valor agregado" id="comentarios"
                        name="comentarios" aria-label="comentarios"
                        placeholder="SUGERENCIAS : Esta sección le agrega valor sugiriendo algo mas sobre el producto"></textarea>
                </div>
            
            </div>
        </div>
        <div class="col-sm-4 mt-1">

            <div class="row justify-content-center">
                <div class="col-sm-6 border mt-1">
                    <div class="row justify-content-center">
                        <input onKeyDown="return validarnumero(event,this.value,6)" onKeyUp="return validarnumero(event,this.value,6)"
                            id="precio" name="precio" type="number" placeholder="$ Precio de venta"
                            class="validate border border-success center tooltipped" data-position="top" data-tooltip="Precio de venta">
                    </div>
                    <div class="row justify-content-center">
                        <!-- <label class="colorletras" for="costo">Indique el $ Costo</label> -->
                        <input onKeyDown="return validarnumero(event,this.value,6)" onKeyUp="return validarnumero(event,this.value,6)"
                            id="costo" name="costo" type="number" class="validate border border-success center tooltipped" data-position="top" data-tooltip="Costo del producto"  placeholder="$ Costo">
                    </div>
                    <div class="row justify-content-center">
                        <label for="opcionantes">
                            <input id="opcionantes" type="checkbox" class="filled-in" />
                            <span class="colorletrasresaltado">Ventaja comercial</span>
                        </label>
                    </div>
                    <div class="row justify-content-center">
                        <input onKeyDown="return validartecla(event,this.value,30)" onKeyUp="return validartecla(event,this.value,30)"
                        id="tituloantes" name="tituloantes" type="text" class="validate border border-danger center tooltipped" data-position="top" data-tooltip="Ej: Precio anterior"
                        placeholder="Título del precio tachado">
                    </div>
                    <div class="row justify-content-center">
                        <input onKeyDown="return validarnumero(event,this.value,6)" onKeyUp="return validarnumero(event,this.value,6)"
                        id="precioantes" name="precioantes" type="number" placeholder="Precio tachado" class="validate border border-danger center"><del></del>
                    </div>
                    <div class="row justify-content-center">
                        <p class='left'>Ej<del id='precioantesprevia'> $ 30000</del></p>
                    </div>
                </div>

                <div class="col-sm-6 border mt-1">
                    <div class="row justify-content-start">
                        <!-- ------- Check de opcion es oferta ------- -->
                        <p>
                            <label>
                                <input id="esoferta" type="checkbox" class="filled-in" />
                                <span class="colorletras">Ver en Promos</span>
                            </label>
                        </p>
                    </div>
                    <div class="row justify-content-start">
                        <!-- ------- Check de opcion es novedad ------- -->
                        <p>
                            <label>
                                <input id="esnovedad" type="checkbox" class="filled-in" />
                                <span class="colorletras">Ver en Novedad</span>
                            </label>
                        </p>
                    </div>

                    <!-- ------- Check de opcion es producto para bonus ------- -->
                    <div class="row justify-content-start">
                        <p>
                            <label>
                                <input id="opcionbonus" type="checkbox" class="filled-in" />
                                <span class="colorletras">Tiene Bonus : </span>
                            </label>
                        </p>
                    </div>
                    <!-- <label class="colorletras" for="bonus">Cantidad</label> -->
                
                    <div class="row justify-content-start">
                        <input onKeyDown="return validarnumero(event,this.value,6)" onKeyUp="return validarnumero(event,this.value,6)"
                        id="bonus" name="bonus" type="number" class="validate border border-success center tooltipped" data-position="top" data-tooltip="Por cuantos puntos bonus puede canjearse" placeholder="Cantidad de bonus">
                    </div>

                    <div class="row justify-content-start">
                        <label>
                            <input id="opcionnopublicar" type="checkbox" class="filled-in" />
                            <span class="" style="color: red;"> No publicar en la web</span>
                        </label>
                    
                    </div>
                    <div class="row justify-content-start">
                        <p style="color: red;">Queda guardado pero no se ve en la web
                    </div>
                    
                </div>
            </div>

        </div>
        <div class="col-sm-2 border mt-1">
            <div class="row justify-content-center">
                <p class='center'>Link a sitio externo</p>
            </div>
            <div class="row justify-content-center">
                <input onKeyDown="return validartecla(event,this.value,50)" onKeyUp="return validartecla(event,this.value,50)"
                    id="textolinkexterno" name="textolinkexterno" type="text" class="validate border border-success center  tooltipped" data-position="top" data-tooltip="Texto a un link externo"
                    placeholder="Ej:Link de Pago">
            </div>
            <div class="row justify-content-center">
                <input onKeyDown="return validartecla(event,this.value,200)" onKeyUp="return validartecla(event,this.value,200)"
                    id="linkexterno" name="linkexterno" type="text" class="validate border border-success center tooltipped" data-position="top" data-tooltip="Pegar el enlace"
                    placeholder="Link al sitio externo">
            </div>
        </div>
    </div>
   
    
    
    
        
    <div class='row justify-content-center'>
        <button class="btn waves-effect" type="button" id="enviar" name="enviar">Guardar
    </div>
        <div class='row justify-content-center'>
            <div class="col"></div>
            <div class="col">
                <p>
                    <label>
                        <input id="opcionnoguardar" type="checkbox" class="filled-in" checked="checked" />
                        <span class="colorletras">No limpiar formulario al guardar </span>
                    </label>
                </p>
            </div>
            <div class="col">
                <input id="id" disabled value="" name="id" type="text" class="m-0 p-0">
            </div>

    </div>


        
                
    <div class="text-center grey lighten-3">
                                    
        <div class="row justify-content-center filamercado">
            <h5 class="textofilamercado"><small>MODIFICAR PRODUCTOS</small></h5>
        </div>

        <div class="row justify-content-center">
        
            <!-- Columna de lista de anuncios -->
            <div class="col-sm-12 center">
                <div class="row justify-content-center">
                    <div class="col-sm-6 center">
                        <select class="form-control" id="opcioneslista" name="opcioneslista"></select>
                    </div>
                </div>
                <div class="row">
                    <div class="table-responsive">
                        <table id="tablaanuncios" class="display table table-striped">
                            <thead>
                                <tr>
                                    <th></th>
                                    <th>Editar</th>
                                    <th>Imagen</th>
                                    <th>Rubro</th>
                                    <th>Título</th>
                                    <th>Descripción</th>
                                    <th>Precio Vta</th>
                                    <th>Costo</th>
                                    <th>Es Promo?</th>
                                    <th>Es Novedad?</th>
                                    <th>se publica?</th>
                                    <th>Es Bonus?</th>
                                    <th>Cantidad Bonus</th>
                                    <th>Ventaja comercial</th>
                                    <th>Titulo Ventaja</th>
                                    <th>Precio tachado</th>
                                    <th>Eliminar</th>
            
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        
        </div>
    </div>
           
      
</form>

<script>


    
    $(document).ready(function () 
    {
        $('.tooltipped').tooltip();

        consultarubros_seleccion_lista(); //llena la lista del buscador
        imageneszoom(); //habilita el zoom para las imagenes
        validarcambioimagen(); //verifica cuando se elige otra imagen en la tarjeta
        configuraciontabla('#tablaanuncios');//configuracion de la tabla
        consultarubros_seleccion(); //llena la lista del alta de anuncio

        function inicioconsulta()
        {
            //agrego un texto que mejora la vista para buscar
            var newItem = document.createElement("h5");
            var textnode = document.createTextNode("Filtro de productos");
            newItem.appendChild(textnode);

            var taf = document.getElementById("tablaanuncios_filter");
            taf.insertBefore(newItem, taf.childNodes[0]);
        }

        
        inicioconsulta(); //trae los anuncios al cargar la pagina

        $("#enviar").click(function () {
            M.toast(
            {
                html: 'Procesando...',
                displayLength: '2000'
            });
            EnviarFormulario();
        });

        $("#limpiar").click(function () {
            limpiarformulario();
        });


        $("#opciones").change(function () {
            var o = document.getElementById("opciones");
            var opcion = o.options[o.selectedIndex].text;
            document.getElementById('rubro').value = opcion;
       
        });

        $('#tablaanuncios').on('page.dt', function () {
            imageneszoom();
        });

        $('#tablaanuncios').on('draw.dt', function () {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
            imageneszoom();
        });

        
        
    });

    $("#nuevoanuncio").click(function(){
        $('#opcionnoguardar').prop('checked',false);
         limpiarformulario();
         $('#opcionnoguardar').prop('checked',true);
    });
   
     $("#opcioneslista").on('change', function () {

        consultaranuncios();
        M.toast(
        {
            html: 'Buscando productos por rubro...',
            displayLength: '3000'
        });
    });



    $("#precioantes").keyup(function(){
        document.getElementById("precioantesprevia").innerText = "$ " + document.getElementById("precioantes").value;
    });

</script>