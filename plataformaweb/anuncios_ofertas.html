
<div id="ofertasanuncios" class="row">


</div> 

<script>



    var bdd = conexionbddpaginaweb;
    var rutadeimagenes = rutaimagenespaginaweb;
    var tabla = tablaanunciospaginaweb;
    var tabladerubros = tablarubrospaginaweb;

    function consultaranunciosofertas(e)
    {
        var seveelprecio = true;

        var tipo;
        tipo = "consultatodosanunciosoferta";

        var t=null;
        var id="";

        if (id == "") id = 0;
        else id = id;

        var itemanuncio = new Object();

        itemanuncio.bdd = bdd;
        itemanuncio.tabla = tabla;
        itemanuncio.tablarubros = tabladerubros;

        itemanuncio.tipo = tipo;
        itemanuncio.id = id;

        itemanuncio.titulo = "";
        itemanuncio.descripcion = "";
        itemanuncio.precio = "";
        itemanuncio.costo = "";
        itemanuncio.esnovedad = "";
        itemanuncio.esoferta = "";
        itemanuncio.nopublicar = "";
        itemanuncio.observaciones = "";
        itemanuncio.comentarios = "";

        itemanuncio.rutaimagenes = rutadeimagenes;
        itemanuncio.idrubro = "";
        itemanuncio.imagen = "";
        itemanuncio.filtro = "";

        var objetoanuncio = JSON.stringify(itemanuncio);

        t = $('#ofertasanuncios');
        $(".hijosofer").remove();

        $.ajax({
            url: "consultaanuncios.php",

            data: { objetoanuncio: objetoanuncio},
            type: "post",

            success: function (data)
            {

                if (data != '[]') 
                {
                    dd = JSON.parse(data); //data decodificado
                    var cuenta = 0;
                    
                    $.each(dd, function (key, value) 
                    {
                       
                        cuenta = cuenta + 1;

                        var parteobservacion = "";
                        var partecomentarios = "";
                        var colapsocomentarios = "";
                        var colapsoobservaciones = "";

                        if (dd[key].observaciones != "") {
                            parteobservacion = "<div class='col'><p><a class='btn light-green lighten-3 text-green darken-4 textobotonextras' data-toggle='collapse' href='#collapseObservaciones" + cuenta + "' role='button' aria-expanded='false' aria-controls='collapseObservaciones" + cuenta + "'>Saber mas...</a></p></div>";
                            colapsoobservaciones = "<div class='collapse' id='collapseObservaciones" + cuenta + "'><div class='card card-body extradescripcion'>" + dd[key].observaciones + "</div></div>";
                        }

                        if (dd[key].comentarios != "") {
                            partecomentarios = "<div class='col'><p><a class='btn light-green lighten-3 yellow-text text-lighten-5 brown darken-1 textobotonextras' data-toggle='collapse' href='#collapseComentarios" + cuenta + "' role='button' aria-expanded='false' aria-controls='collapseComentarios" + cuenta + "'>Sugerencias</a></p></div>";
                            colapsocomentarios = "<div class='collapse' id='collapseComentarios" + cuenta + "'><div class='card card-body extradescripcion'>" + dd[key].comentarios + "</div></div>";
                        }

                        if (dd[key].nopublicar == 0) {
                            if (seveelprecio == true) {

                                var precio;
                                if (dd[key].precio > 0)
                                    precio = "$ " + dd[key].precio;
                                else
                                    precio = "Consultar Precio";
                                t.append("<div class='col-sm-3 hijosofer'><div class='card'><div class='row'><img src='" + rutadeimagenes + dd[key].imagen + "' class='card-img-top materialboxed center-align tamaimagen' alt='...'></img></div><div class='card-body'><h5 class='card-title center'>" + dd[key].titulo + "</h5><p class='card-text center'>" + dd[key].descripcion + "</p><p class='card-text center'>" + precio + "</p></div> <div class='row'>" + parteobservacion + partecomentarios + "</div> <div class='row'>" + colapsoobservaciones + "</div> <div class='row'>" + colapsocomentarios + "</div> </div></div>");

                            }
                        }
                    });

                    imageneszoom();
                }else{
                    Swal.fire({
                        closeOnEsc: false,
                        title: 'No hay ofertas o combos disponibles',

                    })
                }
            },
                error: function (e) 
                {
                    M.toast(
                    {
                        html: 'No hay buena conexión!',
                        displayLength: '4000'
                    });
                console.log("Error de comunicación");
            }
        });
    }

    $(document).ready(function ()
    {

        consultaranunciosofertas();
       
        
    });
</script>