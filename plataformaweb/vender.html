<div id="accordionVentas" class="mt-3 pt-2">
    
    <div class="filafondo row justify-content-center align-items-center">
        <div class="col-sm-2">
            <div class="row">
                <div class="col-sm-6">
                    <h5 style="color: white;" >CAJA</h5>
                </div>
                <div class="col-sm-6">
                    <button id="nuevoclienteventas" style="color: white;" class="waves-effect waves-light btn-small">Clientes</button>
                </div>
            </div>
        </div>

        <div class="col-sm-2">
            <div class="row justify-content-center ">
                <h5 class="m-1 p-1">
                    <input id="fechaventa" type="text" class="datepicker center" readonly>
                </h5>
                <h5 id="fechaventalectura" type="text" style="display: none;"></h5>
            </div>
            <div class="row" style="display: none;">
                <div class="col-sm-4">
                    <input type="text" id="bonusestablecido" value="" class="center" readonly>
                </div>
                <div class="col-sm-8">
                    <p>% de bonus por venta</p>
                </div>
            </div>
        </div>
        
        <div class="col-sd-2">
            <div class="row justify-content-center">
                <select class="form-control m-1 p-1" id="opcioneslistaclientes" name="opcioneslistaclientes"></select>
            </div>
            
        </div>
        <div class="col-sd-2">
            <div class="row justify-content-center">
                <select class="form-control m-1 p-1" id="opcioneslistatiposdepago" name="opcioneslistatiposdepago"></select>
            </div>
        </div>

        <div class="col-sd-2">
            <div class="row justify-content-center">
                <button id="procesarpedido" class="btn btn-primary">Guardar <i class="fas fa-save"></i></button>
            </div>
        </div>
        <div class="col-sd-2">
            <div class="row justify-content-center">
                <input id="totalpedido" value="0" type="text" class="center" style="color: rgb(255, 255, 255);font-size: 1.3em;"
                    readonly>
            </div>
        </div>
    </div>
    <!-- ---------- OBJETO BASE PARA ALTA DE PRODUCTOS-------------- -->
    <div id="divNuevoCliente" style="display: none;"  class="row">
        
    </div>

    <div id="pedido" style="display: none;">
        <!-- lista venta -->
        <div class="row">
            <!-- Columna de tarjeta de ventas -->
            <div class="col-sm-12 notapedido">

                <div class="table-responsive">
                    <table id="tablaitemsventa" class="display table table-striped" style="width: 100%!important;">
                        <thead>
                            <tr>
                                <th>Id</th>
                                <th>Título</th>
                                <th>Cantidad</th>
                                <th>Unidad Vta</th>
                                <th>Precio</th>
                                <th>Sub Total</th>
                                <th>Eliminar</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>

        <hr>
        
    <!-- Buscar para Vender -->
    <div class="row">
        <!-- Columna de lista de anuncios -->
        <div class="col-sm-12">
            <div id="divBuscador" class="row justify-content-center p-4">
                <!-- ------------INSERTA COMPONENTE BUSQUEDA------------------- -->
                

                <!-- ---------------------------------------------------------- -->
            </div>
            <div class=" col-sm-2">
                <!-- cliente elegido -->
                <input style="display: none;" id="idclienteelegido" name="idclienteelegido" type="text">
                <input style="display: none;" id="clienteelegido" name="clienteelegido" type="text">
                <input style="display: none;" id="idtipodepagoelegido" name="idtipodepagoelegido" type="text">
                <input style="display: none;" id="tipodepagoelegido" name="tipodepagoelegido" type="text">
            </div>

            <div id="divverdata" class="row justify-content-start"></div>

            <div id="listaproductos" style="display: none;" class="table-responsive">
                <table id="tablaanunciosvender" class="display table table-striped" style="width: 100%!important;">
                    <thead>
                        <tr>
                            <th class=" center" ></th>
                            <th class=" columnadedos center">Stock</th>
                            <th class="  center">Titulo</th>
                            <th class="  center">$ vta</th>
                            <th class="  center" style="font-size: 0.9em;" ></th>
                            <th class="  center" ></th>
                            <th class=" columnadetres center">cantidad</th>
                            <th class=" columnadedos center">$ lista</th>
                            <th class=" columnadedos">Imagen</th>
                            <th class="columnadedos center">Id</th>
                            <th class="columnadedos center">Codigo Barra</th>
                            <th class="">Descripcion</th>
                            <th class="columnadedos center">Unidad Vta</th>

                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            
                            <td class=" center"></td>
                            <td class=" columnadedos center"></td>
                            <td class= ""></td>
                            <td class="  center"></td>
                            <td class="  center botcelu"></td>
                            <td class="  center"></td>
                            <td class=" columnadedos center"></td>
                            <td class=" columnadedos center"></td>
                            <td class=" columnadedos"></td>
                            <td class=" columnadedos center"></td>
                            <td class="  center"></td>
                            <td class=" columnadedos center"></td>
                            <td class=""></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Fin vender -->

              
    <!-- ------------------------------ lista de ventas del dia ------------------------ -->
    <div class="card">
        <div class="" id="headingListaVenta">
            <h5 class="m-0">
                <button class="btn collapsed" data-toggle="collapse" data-target="#collapseListaVenta"
                    aria-expanded="false" aria-controls="collapseListaVenta">
                    Lista de ventas del día
                </button>
            </h5>
           
            <h5 id="totalventas">0</h5>
            
        </div>
        
        <div id="collapseListaVenta" class="collapse" aria-labelledby="headingListaVenta" data-parent="#accordionVentas">
            <div class="">
                <!-- lista venta -->
                <div class="row m-0 p-0">

                    <!-- Columna de tarjeta de ventas -->
                    <div class="col-sm-12 notapedido">
                    <div id="divverdata1" class="row justify-content-start">
                        <div class="col-sm-1 mt-1">
                            <select class="form-control" id="listareg1" name="listareg1"></select>

                        </div>
                    </div>

                        <div class="table-responsive">
                            <table id="tablavender" class="display table table-striped" style="width: 100%!important;">
                                <thead>
                                    <tr>
                                        <th class=" columnadedos center">Nº Item</th>
                                        <th class=" columnadedos center">Id</th>
                                        <th class=" columnadedos center">Código Barra</th>
                                        <th class="  center">Título</th>
                                        <th class=" columnadedos center">cantidad</th>
                                        <th class=" columnadedos center">Unid.Vta</th>
                                        <th class=" columnadedos center">Precio</th>
                                        <th class=" columnadedos center">Total</th>
                                        <th class=" columnadedos center">Forma Pago</th>
                                        <th class=" columnadedos center">Hora</th>
                                        <th class=" columnadedos center">Id Cliente</th>
                                        <th class=" columnadedos center">Cliente</th>
                                        <!-- <th class=" columnadetres center">usuario</th> -->
                                        <th class=" columnadedos center">Bonus Vta</th>
                                        <th class=" columnadedos center">Eliminar</th>

                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class="  center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class=" columnadedos center"></td>
                                        <!-- <td class=" columnadedos center"></td> -->
                                        <td class=" columnadetres center"></td>
                                        <td class=" columnadedos center"></td>
                                        <td class="blockeliminar"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
                <!-- fin lista venta -->
            </div>
        </div>
    </div>
    
    <!-- ------------------------------------------- CAJA ---------------------------------------- -->
    <div class="card">
        <div class="" id="headingListaCaja">
            <h5 class="m-0">
                <button class="btn collapsed" data-toggle="collapse" data-target="#collapseListaCaja" aria-expanded="false"
                    aria-controls="collapseListaCaja">
                    Lista de Caja del día
                </button>
            </h5>
            <h5 id="totalcaja">0</h5>

        </div>
    
        <div id="collapseListaCaja" class="collapse" aria-labelledby="headingListaCaja" data-parent="#accordionVentas">
            <div class="">
                <!-- lista caja -->
                <div class="row m-0 p-0">
                    <!-- Columna de tarjeta de caja -->
                    <div class="col-sm-12">
    
                        <div class="row justify-content-center bd-highlight">
                            
                            <div class="col-sm-7">
                                <input id="descripcioncaja" min=0 max=150 type="text" placeholder="Descripción">
                            </div>
                            <div class="col-sm-1">
                                <input id="montocaja" type="number" min="0" max="10" placeholder="Monto">
                            </div>
                            <div class="col-sm-2">
                                <button id="ingresocaja" class="btn " style="background-color: cornflowerblue;color:white">Ingresar</button>
                            </div>
                            <div class="col-sm-2">
                                <button id="egresocaja" class="btn btn-red">Retirar</button>
                            </div>
                        </div>
                        <div class="table-responsive">
                            <table id="tablacajas" class="display table table-striped" style="width: 100%!important;">
                                <thead>
                                    <tr>
                                        <th>Nº Item</th>
                                        <th>Id usuario</th>
                                        <th>Usuario</th>
                                        <th>Fecha</th>
                                        <th>Hora</th>
                                        <th>Tipo de movimiento</th>
                                        <th>Monto</th>
                                        <th>Descripción</th>
                                        <th>Eliminar</th>
    
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td></td><td></td><td></td><td></td>
                                        <td></td><td></td><td></td>
                                        <td></td><td class="blockeliminar"></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
    
                </div>
                <!-- fin lista caja -->
            </div>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-sm-4">
            <h5>Resúmen de Caja</h5>
        </div>
    </div>
    
    <!-- ------------------------------------------- RESUMEN ---------------------------------------- -->
    <div class="row justify-content-center">
        <div class="col-sm-4">
            <a id="exportararchivo" style="color: white;" class="waves-effect waves-light btn-small">Exportar <i
                            class="fas fa-shopping-cart" style="color: white;"></i></a>
        </div>
    </div>
    <div class="row justify-content-center">
        <div class="col-sm-4">
            <div class="table-responsive">
                <table id="tablaresumen" class="display table table-striped" style="width: 100%!important;">
                    <thead>
                        <tr>
                            <th></th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>

function consultaventadiaactual() {
    
    consultarventasdeldia();
}

function verificaJerarquia()
{
   
    if(jerarquia == 0)
    {
        document.getElementById("fechaventa").style.display = "none";
        document.getElementById("fechaventalectura").style.display = "inline-flex";
    }
}
    cargarLista1("listareg1");
    function cargarLista1(lista) {
        $("#" + lista).empty();
        var a = [];
        a.push('<option value = "" selected >Todo</option >');
        a = a.concat('<option value = 10 >10</option>');
        a = a.concat('<option value = 25 >25</option>');
        a = a.concat('<option value = 50 >50</option>');
        a = a.concat('<option value = 100>100</option>');
        $("#" + lista).append(a);

        //selecciona el primer item
        $("#" + lista + " option:selected").prop("selected", false);
        $(this).prop("selected", true);
    }

    $("#listareg1").on('change', function () {
        var lr = document.getElementById("listareg1").value;
        var valor = -1;
        if (lr > 0)
            valor = lr;

        verRegistros("tablavender", valor);
    });

    $(document).ready(function () 
    {
        
        configuracalendario();
        consultarbonus();
        consultaclientes_seleccion_lista(); //llena la lista de clientes del buscador
        consultatiposdepago_seleccion_lista(); //llena la lista con tipos de pago
        imageneszoom();

        configuraciontablaPedido();
        configuraciontablavender();
        configuraciontablacajas();
        configuraciontablaanunciosvender();

        $("#divNuevoCliente").load("componenteclientes.html");

        $("#nuevoclienteventas").click(function(){

            MostrarDivNuevoCliente();
        });

        function MostrarDivNuevoCliente()
        {   
            if($("#divNuevoCliente").hasClass("show"))
            {
                $("#divNuevoCliente").css('display','none');
                $("#divNuevoCliente").removeClass('show');
                consultaclientes_seleccion_lista();
            }
            else
            {
                $("#divNuevoCliente").css('display','block');
                $("#divNuevoCliente").addClass('show');
            }
        }

        $('#tablaanunciosvender').on('page.dt', function () {
            imageneszoom();
            identificasaltainput('saltacantidad');
            identificasaltainput('saltaprecio');
        });

        $('#tablaanunciosvender').on('draw.dt', function () {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
            imageneszoom();
            identificasaltainput('saltacantidad');
            identificasaltainput('saltaprecio');
        });

        $("#fechaventa").change(function () {
            consultaventadiaactual();
        });

        $("#opcioneslistaclientes").change(function () {
            var o = document.getElementById("opcioneslistaclientes");
            var opcion = o.options[o.selectedIndex].text;
            document.getElementById('clienteelegido').value = opcion;
        });

        $("#opcioneslistatiposdepago").change(function () {
            var o = document.getElementById("opcioneslistatiposdepago");
            var opcion = o.options[o.selectedIndex].text;
            document.getElementById('tipodepagoelegido').value = opcion;
            eligetipopago();
        });
        
        function colocafechaactual() {
            var f = new Date();
            var mes = f.getMonth() + 1;
            var dia = f.getDate();
            if (dia < 10) {
                dia = "0" + dia;
            }
            if (mes < 10) {
                mes = "0" + mes;
            }
            var fechaactual = dia + "-" + mes + "-" + f.getFullYear();
            document.getElementById("fechaventa").value = fechaactual;
            document.getElementById("fechaventalectura").innerHTML = fechaactual.toString();
            consultaventadiaactual();
        }
        
        colocafechaactual();

        llama = "vender";
        $("#divBuscador").load("componentebuscador.html");

        verificabloqueo();
        verificaJerarquia();
    });

   
    $("#procesarpedido").click(function(){
        procesarventa();
    });

    $("#ingresocaja").click(function()
    {
        var monto = document.getElementById("montocaja").value;
        var descripcion = document.getElementById("descripcioncaja").value;

        guardarcaja("alta", "EN",monto, descripcion);
    });

    $("#egresocaja").click(function () {
            var monto = document.getElementById("montocaja").value;
            var descripcion = document.getElementById("descripcioncaja").value;

            guardarcaja("alta", "SA",monto, descripcion);
        });
    $('.tooltipped').tooltip();

    $("#divverdata").load("componentelistaverdata.html?" + versionts);

    $("#exportararchivo").click(function () {
            exportTableToExcel('tablaresumen', 'resumencajadeldia');
    });
</script>