
    <div class="col-sm-12">
        <div class="row">
            <div class="col-sm-2">
                <div class="row justify-content-center">
                    <form action="#" id="formulario" method="POST" role="form" enctype="multipart/form-data">
            
                        <div class="col-sm-12">
                            <div class="row justify-content-center" style="margin: 0em;">
                                <div class="col">
            
                                    <img id="muestra" src='imagenes/sinimagen.jpg' class='materialboxed card-img-top center-align'
                                        alt='...'></img>
                                </div>
                                <div class="col">
                                    <form action="#">
                                        <div class="file-field input-field">
                                            <div class="btn-sm">
                                                <span>Agregar imagen</span>
                                                <input id="imagen" name="imagen" type="file">
                                            </div>
                                            <div style="display: none;" class="file-path-wrapper">
                                                <input class="file-path validate" type="text" placeholder="Imagen del producto">
                                            </div>
                                        </div>
                                    </form>
                                    <progress style="display: none;" class="progress" id="barra" value="0" max="100">0%</progress>
                                    <label style="display: none;" class="colorletras" for="" id="valorbarra">0%</label>
                                </div>
                            </div>
                            <div class="row justify-content-center" style="margin-bottom: 0em;">
                                <p class="red-text accent-4" id="aviso"></p>
                            </div>
                        </div>
            
            
                    </form>
                </div>
            </div>
            <div class="col-sm-10">
                <div class="row justify-content-center">

                    <div class="col-sm-1">
                        <label for="id">Id producto</label>
                        <input id="id" disabled value="" name="id" type="text" class="m-0 p-0">
                    </div>
                    <div class="col-sm-2">
                        <label for="codigobarra">Código de barras</label>
                        <input id="codigobarra" min="0" maxlength="25" class="border border-success center" type="text" placeholder="Codigo barra">
                    </div>
                    <div class="col-sm-3">
                        <label for="titulo">Nombre del producto/servicio</label>
                        <input onKeyDown="return validartecla(event,this.value,50)" onKeyUp="return validartecla(event,this.value,50)"
                            id="titulo" name="titulo" style="font-size: 1.2em;" type="text"
                            class="validate border border-success center tooltipped" data-position="top" data-tooltip="Título de la publicación"
                            placeholder="Nombre del producto">
                    </div>
                    <div class="col-sm-3">
                        <label for="comodin">Comodín que identifica al producto</label>
                        <input id="comodin" type="text" min="0" maxlength="25" placeholder="Comodín">
                    </div>
                    
                </div>
               
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-sm-9">
                <div class="input-group">
                    <div class="input-group-prepend">
                        <span class="input-group-text">Descripción</span>
                    </div>
                    <textarea maxlength="200" class="form-control tooltipped" data-position="top"
                        data-tooltip="Descripción del producto" id="descripcion" name="descripcion" aria-label="descripcion"
                        style="height: 50px;" class="border border-success"
                        placeholder="Ej: Varios talles y colores unisex, talles de niños y adultos"></textarea>
                </div>
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-sm-4">
                <input style="display: none;" id="idcomovende" name="idcomovende" type="text"
                    class="validate border border-success">
                <select class="form-control" id="comovende" name="comovende">
                    <option value="0">Vta x Unidad</option>
                    <option value="1">Vta Fraccionada</option>
                </select>
            </div>
        </div>

        <div class="row justify-content-center">
            <div class="col-sm-2">
                <input id="costo" name="costo" type="text" min="0" maxlength="12" step="0.01"
                    class="validate border border-primary center tooltipped" data-position="top"
                    data-tooltip="Costo del producto" placeholder="$ Costo">
            </div>
            <div class="col-sm-2">
                <input id="margenganancia" name="margenganancia" onKeyUp="return calcularprecio()" type="text" min="0" maxlength="12" step="0.01"
                    class="validate border border-primary center tooltipped" data-position="top" data-tooltip="Margen de ganancia"
                    placeholder="% ganancia">
            </div>
            <div class="col-sm-2">
                <input onKeyDown="return validartecla(event,this.value,6)" onKeyUp="return calcularmargen()"
                    id="precio" name="precio" type="text" min="0" maxlength="12" step="0.01" placeholder="$ Precio de venta"
                    class="validate border border-success center" data-position="top" data-tooltip="Precio de venta">
            </div>
        
        </div>
        <div class="row justify-content-center">
            <div id="divprefijocompra" class="col-sm-2" style="display: none;">
                <input style="display: none;" id="idprefijocompra" name="idprefijocompra" type="text"
                    class="validate border border-success">
                <select class="form-control" id="prefijoxcompra" name="prefijoxcompra">
            
                    <!-- aca se inserta la consulta de prefijos por compra -->
            
                </select>
            </div>
            <div id="divprefijoventa" class="col-sm-2" style="display: none;">
                <input style="display: none;" id="idprefijoventa" name="idprefijoventa" type="text"
                    class="validate border border-success">
                <select class="form-control" id="prefijoxventa" name="prefijoxventa">
            
                    <!-- aca se inserta la consulta de prefijos por venta -->
            
                </select>
            </div>
        </div>
        <div class="row justify-content-center">
            <div id="divpreciocomprapref" class="col-sm-2" style="display: none;">
                <input onKeyUp="return CalcularValoresFraccionados()" id="costofraccionado" class="border-2 border-primary center" type="text" placeholder="Costo segun unid compra" min="0" maxlength="12" step="0.01">
            </div>
            <div id="divprecioventapref" class="col-sm-2"  style="display: none;">
                <input onKeyUp="return CalcularValoresFraccionadosventa()" id="ventafraccionado" class="border-2 border-success center" type="text" placeholder="Precio Vta x unid compra" min="0" maxlength="12" step="0.01">
            </div>
        </div>
        <div class="row justify-content-center">
            
            <div class="col-sm-4">
                <p>
                    <label>
                        <input id="opcionnoguardar" type="checkbox" class="filled-in"/>
                        <span class="colorletras">No limpiar formulario al guardar </span>
                    </label>
                </p>
            </div>
            <div class="col-sm-4">
                <button class="btn waves-effect" type="button" id="enviar" name="enviar">Guardar
            </div>
            <div class="col-sm-4">
                <p>
                    <label>
                        <input id="opcionocultarprecio" type="checkbox" class="filled-in" checked="checked" />
                        <span class="colorletras">Ocultar precio</span>
                    </label>
                </p>
            </div>
        </div>

        

    </div>
    

<script>


    function comovende() {
        document.getElementById("idcomovende").value = document.getElementById("comovende").value;
        var op = $("#idcomovende").val();
        return op;
    }

    function CalcularValoresFraccionadosventa()
    {
        CalcularValoresFraccionados();
        calcularmargen();
        
    }

    function calcularmargen() {
            var pv = 0;
            var co = 0;

            if (comovende() == 0) {
                pv = document.getElementById("precio").value;
                co = document.getElementById("costo").value;
            }
            else {
                pv = document.getElementById("ventafraccionado").value;
                co = document.getElementById("costofraccionado").value;
            }

            var ma = document.getElementById("margenganancia");

            ma.value = CalculaMargenSegunPrecio(pv, co);

           
            
    }

    function calcularprecio() {
        var ma = 0;
        var co = 0;
        if (comovende() == 0) {
            ma = document.getElementById("margenganancia").value;
            co = document.getElementById("costo").value;
        }
        else {
            ma = document.getElementById("margenganancia").value;
            co = document.getElementById("costofraccionado").value;
        }

        var pr = 0;
        if(ma == NaN) ma = 0;

        pr = CalculaPrecioSegunMargen(co, ma);

        if (comovende() == 0) {
            document.getElementById("precio").value = pr;

        } else {
            document.getElementById("ventafraccionado").value = pr;
            CalcularValoresFraccionadosventa();

           
        }

       
    }

    
    $(document).ready(function () 
    {
        imageneszoom(); //habilita el zoom para las imagenes
        validarcambioimagen(); //verifica cuando se elige otra imagen en la tarjeta

        $("#enviar").click(function () {
            M.toast(
                {
                    html: 'Procesando...',
                    displayLength: '2000'
                });
            EnviarFormulario();
        });


        $("#comovende").change(function(){
            unCambioComoVende();

        });

        consultaUnidadesGranel("consultatodo");
        mostrarDivPrefijoCompra(0);

        
        $("#prefijoxcompra").change(function(){

            unCambioPrefijoCompra();

        });

        $("#prefijoxventa").change(function () 
        {
            unCambioPrefijoVenta();
        });

        
        
    });

</script>